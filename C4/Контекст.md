@startuml
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Container.puml

!define DEVICONS https://raw.githubusercontent.com/tupadr3/plantuml-icon-font-sprites/master/devicons
!define FONTAWESOME https://raw.githubusercontent.com/tupadr3/plantuml-icon-font-sprites/master/font-awesome-5
!include DEVICONS/react.puml
!include DEVICONS/python.puml
!include DEVICONS/postgresql.puml
!include FONTAWESOME/users.puml


LAYOUT_WITH_LEGEND()

Person(user, "Пользователи", "Люди которые нуждаются в продукте", $sprite="users")
Container(spa, "SPA", "ReactTS", "Основной интерфейс, с которым взаимодействует клиент", $sprite="React")
Container(api_1, "API", "Python, Fast-api", "Обработка логики заполнения базы данных", $sprite="python")
ContainerDb(db, "Database", "PostgresSQL", "Хранит информацию о функциях, пользователях и триггерах", $sprite="msql_server")


Person_Ext(external_user, "Внешние сервисы", "Сервисы которые отправляют нам данные", $sprite="users")
Container(api_2, "API_triggers", "Python", "Обработка запросов, на запуск функций по триггеру", $sprite="python")
Container(api_2, "API_triggers", "Python", "Обработка запросов, на запуск функций по триггеру", $sprite="celery")

System(docker, "Докер", "Создание контейнера, выполнение кода, получение результата")

Rel(user, spa, "Использует", "https")
Rel(spa, api_1, "Использует", "https")
Rel_R(api_1, db, "Чтение/запись")

Rel(external_user, api_2, "Использует", 'https')
Rel_L(api_2, db, "Чтение")
Rel(api_2, docker, 'Отправка')
@enduml